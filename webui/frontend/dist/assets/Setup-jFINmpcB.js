import{d as K,r as c,o as P,c as d,a as w,b as a,F as C,e as o,t as S,w as t,f as n,n as T,u as N,g as u,h as V,i as D,E as i,s as E,j as R,k as A,_ as F}from"./index-X1O1lxeu.js";const I={class:"setup-page"},U={class:"recovery-section"},H={class:"key-display"},W={class:"form-section"},Z={key:0},q={key:1},G=K({__name:"Setup",setup(J){const L=N(),l=c(!1),b=c(!1),s=c({password:"",confirmPassword:""}),v=c(""),y=c(!1),_=c(""),z=async()=>{try{await navigator.clipboard.writeText(v.value),i.success("已复制到剪贴板")}catch{i.error("复制失败，请手动复制")}},M=async()=>{l.value=!0;try{const r=await R.login(_.value);r.code===0&&A(r.data.token),L.push("/")}finally{l.value=!1}},g=async()=>{if(!s.value.password){i.error("请输入密码");return}if(s.value.password!==s.value.confirmPassword){i.error("两次密码输入不一致");return}if(s.value.password.length<6){i.error("密码长度至少 6 位");return}l.value=!0;try{const r=await E.init(s.value.password);r.code===0?(_.value=s.value.password,v.value=r.data.recovery_key,y.value=!0,i.success("初始化完成")):i.error(r.msg)}finally{l.value=!1}};return P(()=>{setTimeout(()=>{b.value=!0},100)}),(r,e)=>{const B=n("DocumentCopy"),p=n("el-icon"),m=n("el-button"),k=n("Lock"),h=n("el-input"),x=n("el-form-item"),j=n("el-form");return u(),d("div",I,[e[8]||(e[8]=w('<div class="bg-decoration" data-v-013b01ce><div class="circle circle-1" data-v-013b01ce></div><div class="circle circle-2" data-v-013b01ce></div><div class="circle circle-3" data-v-013b01ce></div><div class="grid-pattern" data-v-013b01ce></div></div>',1)),a("div",{class:T(["setup-card",{"card-visible":b.value}])},[y.value?(u(),d(C,{key:0},[e[5]||(e[5]=w('<div class="logo-section" data-v-013b01ce><div class="logo-icon success-icon" data-v-013b01ce><svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-013b01ce><path d="M20 25L23 28L30 20" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" data-v-013b01ce></path><circle cx="24" cy="24" r="18" stroke="currentColor" stroke-width="2" data-v-013b01ce></circle></svg></div><h1 class="title" data-v-013b01ce>保存恢复密钥</h1><p class="subtitle" data-v-013b01ce>请妥善保存以下恢复密钥，忘记密码时可用于重置</p></div>',1)),a("div",U,[e[4]||(e[4]=a("div",{class:"warning-box"},[a("svg",{class:"warning-icon",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),a("span",null,"此密钥仅显示一次，关闭后无法再次查看！")],-1)),a("div",H,[a("code",null,S(v.value),1)]),o(m,{type:"primary",class:"copy-btn",onClick:z},{default:t(()=>[o(p,null,{default:t(()=>[o(B)]),_:1}),e[2]||(e[2]=V(" 复制密钥 ",-1))]),_:1}),o(m,{type:"primary",size:"large",loading:l.value,onClick:M,class:"submit-btn"},{default:t(()=>[...e[3]||(e[3]=[V(" 我已保存，继续 ",-1)])]),_:1},8,["loading"])])],64)):(u(),d(C,{key:1},[e[6]||(e[6]=w('<div class="logo-section" data-v-013b01ce><div class="logo-icon" data-v-013b01ce><svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-013b01ce><path d="M24 4L4 14V34L24 44L44 34V14L24 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-013b01ce></path><path d="M4 14L24 24L44 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-013b01ce></path><path d="M24 24V44" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-013b01ce></path><circle cx="24" cy="24" r="6" stroke="currentColor" stroke-width="2" data-v-013b01ce></circle></svg></div><h1 class="title" data-v-013b01ce>系统初始化</h1><p class="subtitle" data-v-013b01ce>首次使用，请设置管理员密码</p></div>',1)),a("div",W,[o(j,{model:s.value,"label-position":"top"},{default:t(()=>[o(x,{label:"管理员密码"},{default:t(()=>[o(h,{modelValue:s.value.password,"onUpdate:modelValue":e[0]||(e[0]=f=>s.value.password=f),type:"password",placeholder:"请输入密码 (至少 6 位)",size:"large","show-password":""},{prefix:t(()=>[o(p,null,{default:t(()=>[o(k)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(x,{label:"确认密码"},{default:t(()=>[o(h,{modelValue:s.value.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=f=>s.value.confirmPassword=f),type:"password",placeholder:"请再次输入密码",size:"large","show-password":"",onKeyup:D(g,["enter"])},{prefix:t(()=>[o(p,null,{default:t(()=>[o(k)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(m,{type:"primary",size:"large",loading:l.value,onClick:g,class:"submit-btn"},{default:t(()=>[l.value?(u(),d("span",q,"设置中...")):(u(),d("span",Z,"完成设置"))]),_:1},8,["loading"])]),_:1},8,["model"])])],64)),e[7]||(e[7]=a("div",{class:"footer-info"},[a("span",null,"Initial Setup Wizard")],-1))],2)])}}}),Q=F(G,[["__scopeId","data-v-013b01ce"]]);export{Q as default};
